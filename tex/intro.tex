%# -*- coding: utf-8-unix -*-
% !TEX program = xelatex
% !TEX root = ../thesis.tex
% !TEX encoding = UTF-8 Unicode
%%==================================================
%% chapter01.tex for SJTU Master Thesis
%%==================================================

%\bibliographystyle{sjtu2}%[此处用于每章都生产参考文献]
\chapter{概述}
\label{chap:intro}

\section{研究背景}

作为一类重要的数据结构，索引在各种系统中发挥着重要的作用，其中包括操作系统（Operating System）、
数据库系统（Database）与文件系统（File System）等。
例如数据库系统中大量使用一级索引（Primary Index）和二级索引（Secondary Index）提高点查（Point Lookup）、
连接（Join）等操作的性能；文件系统常用基于inode的索引结构完成文件查找等操作。
传统的索引结构，包括B树（B-tree）、前缀数（Trie）与哈希表（Hash Table）在过去的几〸年内被广泛研究，
针对不同的应用场景，如读多写少、写多读少、大量小文件写操作等，各式各样的变种索引结构相继被提出[]。

2018年，谷歌提出基于机器学习（Machine Learning）的索引结构\cite{kraska2018case}，将索引视为从键（Key）到数据位置的函数映射，通过多层级{\model}结构，
使用包括{\nn}在内的多种{\model}拟合这一函数关系。
论文提出了三类学习索引：有序索引（Sorted Index）、无序索引（Unsorted Index）和存在索引（Existence Index），
其中有序索引与无序索引使用相同的架构设计，{\rmi}（Recursive Model Index，RMI）。
本文主要讨论使用{\rmi}的{\li}。
相比于传统索引结构，{\li}不能提供精确定位，相反{\li}为给定搜索键提供包含误差的预测位置和搜索范围。
对于存在的键，{\li}保证数据真实位置在给定的搜索范围内。
作为一种新型索引结构，{\li}去除了传统树状索引结构中存在的大量中间节点（Inner Node），不仅减少了查询的执行时间，
还降低了索引结构的空间消耗。

然而，原论文\cite{kraska2018case}对{\li}的测试与分析较为初步，甚至被一些研究人员认为会具有误导性\cite{throwalgo}。
他们假设工作场景是只读的，即被索引的数据是固定不变，{\li}不需要处理更新操作，并假设访问是均匀分布的，
即所有数据被访问的概率是相同的。
另一方面，在真实场景下，伴随着写操作的执行，索引数据是频繁变化的\cite{tpcc}。
同时，真实场景下数据访问是具有偏向性（Skewed）的\cite{zhang2016reducing, debrabant2013anti, eldawy2014trekking, levandoski2013identifying}，
即数据存在冷热之分，大量数据访问发生在少量的热点数据上。
这些广泛存在于真实场景里的动态场景为{\li}的应用带来了许多挑战与机遇。

本文希望进一步探索分析{\li}在动态场景下所面临的挑战，并针对性地提出解决方案，拓宽{\li}的应用范围。

\section{研究现状}

本节将围绕{\li}与动态场景下的索引进行介绍。

\subsection{{\li}相关研究}

Michael\cite{NIPS2018_7328}对提出的存在索引\cite{kraska2018case}，学习布隆过滤器（Learned Bloom Filter），进行数学建模与分析，
讨论了它相对于传统布隆过滤器不一样的性能保证，并分析了学习布隆过滤器对数据分布的要求。
基于数学分析，Michael通过在学习布隆过滤器前额外增加一层传统布隆过滤器，
提出三明治学习布隆过滤器（Sandwiched Learned Bloom ﬁlter）有效提高了学习布隆过滤器的工作性能。

Tim等人提面向分析处理的数据库SageDB\cite{kraska2019sagedb}。
SageDB提出通过机器学习对数据分布、工作场景与硬件环境进行建模，获得最优的数据结构、访问方式与查询执行计划。
具体的，SageDB广泛使用{\li}对一维与高维键进行索引。
对于高维键，SageDB提出使用映射的方式，将键从高维空间映射到一维空间中，从而使用原有的{\li}进行索引。
同时，SageDB拓展了{\li}的应用场景，讨论了磁盘数据与数据压缩等方面的可能性。

\subsection{动态场景下的索引结构}

相比于{\li}，通用的传统索引结构通常不会对索引使用场景作过强的假设，
它们往往能够在不同的场景下都有类似的性能表现。
尽管如此，针对特定的动态场景，研究人员依旧通过设计出具体的索引结构变体，来提高在此场景下的索引性能。

Huanchen等人提出混合索引\cite{zhang2016reducing}（Hybrid Index），针对具有访问偏向性的动态场景进行优化。
混合索引通过冷热数据分离的方法，使用空间使用较少的、更新较灵活的热存储（Hot Store）来处理写操作，
用较为紧凑且只读的冷存储（Cold Store）来存储大量的索引条目。
因为动态场景下的访问偏向性，热存储可以高效利用内存资源，并且减少索引延时，从而提供高吞吐量。

John等人提出分型树\cite{esmet2012tokufs}（Fractal Tree），针对写频繁且单次写数据量较少的动态场景进行优化。
分型树为每个节点配备了一定比例的缓存空间，所有的写操作都会先缓存在根结点里，
当节点缓存用尽后再被批量传播到各自对应的子节点中。
通过这种方法，对于频繁的小数据量写操作的动态场景，分型树将写操作带来的索引结构更新操作合并在一起，
减少索引结构更新操作对性能的影响。
同时，对于存在访问偏向性的动态场景，分型树的节点缓存能够很好地在索引树的较高节点位置处理热点数据的更新，
避免了数据的重复写入。

\section{主要研究内容}

本文首先介绍传统索引结构、机器学习与{\li}。
然后，结合测试与分析，本文探究在动态场景下，{\li}所面临的挑战以及挑战背后的原因。
具体的，我们探究动态变化的索引数据对{\li}性能的影响以及访问偏向性对{\li}性能的影响。
动态场景带来的挑战源自于两个方面，一是{\li}的性能依赖于架构选择与数据分布，并且难以通过数学表达式进行预测；
二是{\li}假设访问模式为均匀访问，从而在设计与训练的过程中缺乏对访问模式信息的有效利用。
针对以上原因，本文提出使用模型缓存（Model Cache）和数据拉伸（Data Stretching）的方法，
构建针对动态场景的学习索引系统，{\sys}，来有效应对动态场景下{\li}面临的挑战，
同时保留{\li}的优秀特性，从而拓宽{\li}的应用范围。

总体来说，本文的贡献如下：
\begin{itemize}
  \item 探究并分析了{\li}在动态场景下面临的挑战；
  \item 提出了{\sys}，一个针对动态场景的学习索引系统；
  \item 通过实验验证了{\sys}的有效性。
\end{itemize}

\section{论文组织结构}

本论文各章节的组织结构如下：

第一章阐述了本文的研究背景，对{\li}的相关研究以及动态场景下的索引结构进行了介绍，阐明了本文的研究内容以及文章的组织结构。

第二章对传统索引结构、机器学习以及{\li}相关背景知识进行介绍。

第三章介绍了在动态场景下{\li}面临的两大挑战：1）动态数据分布带来的挑战与2）访问模式带来的挑战，并详细分析了挑战背后的原因，
为{\sys}提供了分析支撑。

第四章提出了针对动态场景的学习索引系统，{\sys}，并通过实验验证了本系统的有效性。

第五章总结全文，对本文的研究中的不足与局限之处进行了阐述，并针对性的提出了未来工作的展望。
